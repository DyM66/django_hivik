{% load my_tags %}
<div class="container-fluid">
    <div class="d-flex justify-content-end mb-2">
        <!-- Botón Editar -->
        <a href="{% url 'dth:nomina_update' nomina.id %}" class="btn btn-sm btn-outline-secondary me-2" title="Editar registro">
            <i class="bi bi-pencil-square"></i>
        </a>

        <!-- Botón Editar -->
        <a href="{% url 'dth:nomina_update' nomina.id %}" class="btn btn-sm btn-outline-secondary me-2" title="Editar registro">
            <i class="bi bi-pencil-square"></i>
        </a>
    </div>

    <!-- Nav tabs (Bootstrap) -->
    <ul class="nav nav-tabs" id="nominaDetailTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="basic-info-tab" data-bs-toggle="tab" data-bs-target="#basicInfo" type="button" role="tab" aria-controls="basicInfo" aria-selected="true">
                Información Básica
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="personal-data-tab" data-bs-toggle="tab" data-bs-target="#personalData" type="button" role="tab" aria-controls="personalData" aria-selected="false">
                Datos Personales
            </button>
        </li>
    </ul>

    <div class="tab-content py-3">
        <!-- TAB 1: INFORMACIÓN BÁSICA -->
        <div class="tab-pane fade show active" id="basicInfo" role="tabpanel" aria-labelledby="basic-info-tab">
            <div class="row g-3">
                <div class="col-md-4 text-center">
                    <img src="{{ nomina.photo_url }}" alt="Foto" class="img-fluid rounded shadow mb-3">
                </div>

                <div class="col-md-4">
                    <h4 class="fw-bold">{{ nomina.name }} {{ nomina.surname }}</h4>
                    <hr>
                    <p class="mb-1"><strong>Cédula:</strong> {{ nomina.id_number }}</p>
                    <p class="mb-1"><strong>Cargo:</strong> {{ nomina.position_id }}</p>
                    <p class="mb-1"><strong>Es conductor:</strong> {% if nomina.is_driver %}Sí{% else %}No{% endif %}</p>
                    <p class="mb-1"><strong>Estado:</strong>
                        {% if nomina.employment_status == 'a' %}Activo
                        {% elif nomina.employment_status == 'r' %}Retirado
                        {% elif nomina.employment_status == 'l' %}Licencia
                        {% elif nomina.employment_status == 's' %}Suspendido
                        {% elif nomina.employment_status == 'i' %}Incapacitado
                        {% endif %}
                    </p>
                
                    <p class="mb-1"><strong>Email:</strong> {{ nomina.email|default:"N/A" }}</p>
                    <p class="mb-1"><strong>Teléfono:</strong> {{ nomina.phone|default:"N/A" }}</p>
                </div>

                <!-- SECCIÓN DE DOCUMENTOS REQUERIDOS -->
                <div class="mt-4 pt-3" style="border-top: 1px solid #ddd;">
                    <h5>Documentos Requeridos</h5>
                    <p class="text-muted small mb-2">Estado de los documentos exigidos por el cargo</p>
                
                    {% if doc_status_list %}
                    <table class="table table-striped table-sm align-middle" style="max-width: 600px;">
                        <thead class="table-dark">
                            <tr>
                                <th>Documento</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for item in doc_status_list %}
                            <tr>
                                <td>{{ item.document_name }}</td>
                                <td>
                                    {% if item.state == 'Ok' %}
                                        <span class="badge bg-success">{{ item.state }}</span>
                                        {% if item.file_url %}
                                        <a href="{{ item.file_url }}" target="_blank" class="ms-2">
                                            <i class="bi bi-box-arrow-up-right"></i>
                                        </a>
                                        {% endif %}
                                    {% elif item.state == 'Pendiente' %}
                                        <span class="badge bg-warning text-dark">{{ item.state }}</span>
                                    {% elif item.state == 'Vencido' %}
                                        <span class="badge bg-danger">{{ item.state }}</span>
                                        {% if item.file_url %}
                                        <a href="{{ item.file_url }}" target="_blank" class="ms-2">
                                            <i class="bi bi-box-arrow-up-right"></i>
                                        </a>
                                        {% endif %}
                                    {% else %}
                                        <span>{{ item.state }}</span>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                        <div class="alert alert-info">
                            No se han configurado documentos para este cargo.
                        </div>
                    {% endif %}
                </div>
            </div>
            
        </div>

    </div>
</div>
