{% extends "got/base_generic.html" %}

{% block head %}Listado de Ordenes de trabajo{% endblock %}

{% block content %}
    <section class="container d-flex justify-content-between flex-wrap align-items-center">
    <div>
        <a class="btn btn-primary space" href="{% url 'got:ot-create' %}">Crear OT</a>
    </div>

    <div class="btn-group" role="group" aria-label="Estado de OT">
        <input type="radio" class="btn-check" name="state" id="Todos" autocomplete="off" checked>
        <label class="btn btn-outline-primary" for="abierto" onclick="window.location.href='{% url 'got:ot-list' %}'">Todos</label>

        <input type="radio" class="btn-check" name="state" id="abierto" autocomplete="off" {% if request.GET.state == 'a' %}checked{% endif %}>
        <label class="btn btn-outline-primary" for="abierto" onclick="window.location.href='{% url 'got:ot-list' %}?state=a'">Abierto</label>
      
        <input type="radio" class="btn-check" name="state" id="ejecucion" autocomplete="off" {% if request.GET.state == 'x' %}checked{% endif %}>
        <label class="btn btn-outline-primary" for="ejecucion" onclick="window.location.href='{% url 'got:ot-list' %}?state=x'">En ejecución</label>
      
        <input type="radio" class="btn-check" name="state" id="finalizado" autocomplete="off" {% if request.GET.state == 'f' %}checked{% endif %}>
        <label class="btn btn-outline-primary" for="finalizado" onclick="window.location.href='{% url 'got:ot-list' %}?state=f'">Finalizado</label>
        
        <input type="radio" class="btn-check" name="state" id="cancelado" autocomplete="off" {% if request.GET.state == 'c' %}checked{% endif %}>
        <label class="btn btn-outline-primary" for="cancelado" onclick="window.location.href='{% url 'got:ot-list' %}?state=c'">Cancelado</label>
    </div>
    

    <div style="padding: 10px 0">
    <form method="GET" action="{% url 'got:ot-list' %}" class="form" autocomplete="off">
        <div class="input-group flex-nowrap" style="width: 500px;">
            <span class="input-group-text" id="addon-wrapping">Descripción</span>
            {{ form.description }}
            <input type="submit" value="Buscar" class="btn btn-primary">
        </div>  
    </form>
    </div>

    </section>
      
    {% if request.GET.description %}
        <h5>Resultados de búsqueda para: "{{ request.GET.description }}"</h5>
    {% endif %}
    

    <table class="table table-hover">
        <thead>
            <tr>
                <th scope="col">OT-#</th>
                <th scope="col">Fecha</th>
                <th scope="col">Descripción</th>
                <th scope="col">Sistema</th>
                <th scope="col">Supervisor</th>
                <th scope="col">Estado</th>
            </tr>
        </thead>
        <tbody>
            {% if ot_list %}
                {% for ot in ot_list %}
                <tr>
                    <th scope="row">OT-{{ot.num_ot}}</td>
                    <td>{{ot.creation_date|date:"d/m/Y"}}</td>
                    <td><a href="{{ ot.get_absolute_url }}">{{ot.description}}</a></td>
                    <td>{{ot.system}}</td>
                    <td>{{ot.super.first_name}} {{ot.super.last_name}}</td>
                    <td>{{ot.get_state_display}}</td>
                </tr>
                {% endfor %}
                
            {% else %}
                <p>No hay ordenes de trabajo en la registrados.</p>
            {% endif %}
        </tbody>
    </table>

{% endblock %}