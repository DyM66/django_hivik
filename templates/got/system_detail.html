{% extends "got/base_generic.html" %}

{% block head %}
<a href="{% url 'got:asset-detail' system.asset.id %}"><i class="bi bi-arrow-90deg-left"></i></a>
{{ system.asset }}/{{ system.name }}
{% endblock %}

{% block content %}

<div class="container">
    <button type="button" class="btn btn-primary space" data-bs-toggle="modal" data-bs-target="#comModal">
        Crear nuevo componente
    </button>
</div>

{% if system.equipos.all %}
{% for equipo in system.equipos.all %}

	<div class="container mt-5">
    	<div class="row">
        	<!-- Información General del Equipo -->
        	<div class="col-md-6">
				<div>
            		<h2>{{equipo.name}}</h2>
                	<a href="{% url 'got:equipo-delete' equipo.code %}"><i class="bi bi-file-earmark-minus-fill"></i></a>
                	<a href="{% url 'got:equipo-update' equipo.code %}"><i class="bi bi-pen"></i></a>
            	</div>
            	
				<p><strong>Modelo:</strong>  {{equipo.model}}</p>
            	<p><strong>Marca:</strong>  {{equipo.marca}}</p>
            	<p><strong>Serial:</strong> {{equipo.serial}}</p>
            	<p><strong>Fecha ingreso al inventario:</strong> {{equipo.date_inv}}</p>
            	<p><strong>codigo interno:</strong> {{equipo.code}}</p>
            	<p><strong>Estado:</strong> {{system.get_state_display}}</p>
				<h4><strong>Información Específica del Equipo</strong></h4>
          		<p><strong>Fabricante:</strong> {{equipo.fabricante}}</p>
          		<p><strong>Especificaciones:</strong> {{equipo.feature}}</p>
        	</div>
  			{% if equipo.imagen %}
  				<div class="col-md-6">
      				<img src="{{ equipo.imagen.url }}" alt="Imagen del Equipo" class="img-fluid">
      				<!-- La clase "img-fluid" hace que la imagen sea responsiva y se ajuste al ancho del contenedor -->
  				</div>
  			{% endif %}
    	</div>

    	<!-- Repite la estructura para más equipos si es necesario -->
	</div>

{% endfor %}
{% else %}
<p>No hay equipos registrados.</p>
{% endif %}

<div class="container mt-5">

    <div class="container">
        <!-- <button type="button" class="btn btn-primary space" data-bs-toggle="modal" data-bs-target="#sysModal">
            Crear nuevo sistema
        </button> -->
        <h2>Rutinas de mantenimiento</h2>

		<div class="container">
			<button type="button" class="btn btn-primary space" data-bs-toggle="modal" data-bs-target="#rutaModal">
				Crear nuevoa rutina
			</button>
		</div>
        {% if system.rutas.all %}
        <table class="table table-striped">
            <thead>
                <tr>
                    <th scope="col">Codigo</th>
                    <th scope="col">Frecuencia (días)</th>
                    <th scope="col">Fecha de ultima intervención</th>
                    <th scope="col">Fecha proxima intervención</th>
                </tr>
            </thead>
            <tbody>           
                {% for ruta in system.rutas.all %}
                    <tr>
                        <th scope="row">{{ruta.code}}</th>
                        <td><a href="">{{ruta.frecuency}}</a></td>
                        <td>{{ ruta.intervention_date }}</td>
                        <td>{{ ruta.next_date }}</td>
                        <td>
                            <a class="" href="{% url 'got:ruta-update' ruta.code %}"><i class="bi bi-pen"></i></a>
                        </td>
                        <td>
                        <a class="" href="{% url 'got:ruta-delete' ruta.code %}"><i class="bi bi-file-earmark-minus-fill"></i></a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        
        {% else %}
        <p>No hay rutinas registrados.</p>
        {% endif %}
    </div>
</div>


<div class="modal fade" id="comModal" tabindex="-1" aria-labelledby="comModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="comModalLabel">Crear nuevo componente</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form method="post" action="" enctype="multipart/form-data">
            {% csrf_token %}
            <table>
              {{ equipo_form.as_table }}
            </table>
            <button type="submit" class="btn btn-primary">Agregar</button>
          </form>
        </div>
      </div>
    </div>
  </div>


  <div class="modal fade" id="rutaModal" tabindex="-1" aria-labelledby="rutaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="rutaModalLabel">Crear nueva rutina</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form method="post" action="">
            {% csrf_token %}
            <table>
              {{ ruta_form.as_table }}
            </table>
            <button type="submit" class="btn btn-primary">Agregar</button>
          </form>
        </div>
      </div>
    </div>
  </div>


{% endblock %}