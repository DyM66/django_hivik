{% extends "got/base/base_generic.html" %}
{% load my_tags %}
{% block content %}
<style>
    .combined-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        font-size: 0.9em;
    }
    .combined-table th, .combined-table td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: center;
    }
    .combined-table th {
        background-color: #4d93d9;
        color: #fff;
    }
    .group-row {
        background-color: #d9edf7;
        font-weight: bold;
    }
</style>

<div class="dashboard-container">
    <h1>Plan de Mantenimiento Global - Barcos (Rutinas Nivel 3)</h1>
    <p>
        Filtro:
        {% if filter_year and filter_month %}
            Mes: {{ filter_month }}/{{ filter_year }}
        {% else %}
            Todos
        {% endif %}
    </p>
    <table class="combined-table">
        <thead>
            <tr>
                <th>Asset / Rutina</th>
                <th>Nivel</th>
                <th>Planificado</th>
                <th>Ejecutado</th>
                <th>Costo Pendiente</th>
            </tr>
        </thead>
        <tbody>
            {% for row in combined_rows %}
                {% if row.group %}
                    <tr class="group-row">
                        <td colspan="5">
                            Asset: {{ row.asset.name }} ({{ row.asset.abbreviation }}) - Total: {{ row.grand_total|currency }}
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td>{{ row.routine_name }}</td>
                        <td>{{ row.level }}</td>
                        <td>{{ row.planned }}</td>
                        <td>{{ row.actual }}</td>
                        <td>{{ row.cost|currency }}</td>
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
